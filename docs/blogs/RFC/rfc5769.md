---
title: rfc5769
category: rfc
desc: Test Vectors for Session Traversal Utilities for NAT (STUN)
tag:
  - rfc
picture: https://libra321.oss-cn-huhehaote.aliyuncs.com/img/boxmodel.png
date: "2023-05-24"
---

## 摘要

NAT 会话遍历实用程序（STUN）协议定义了几个 STUN 属性。 其中一些的内容 - FINGERPRINT，MESSAGE-INTEGRITY 和 XOR-MAPPED-ADDRESS - 涉及二进制逻辑操作（哈希，xor）。 本文为这些属性提供了测试向量。

## 简介

该文档是关于 STUN 协议的测试向量，其中 STUN 协议定义了两种不同的哈希，可能包含在实现该协议的对等方交换的消息中：

- FINGERPRINT 属性：32 位循环冗余校验。
- MESSAGE-INTEGRITY 属性：HMAC-SHA1 身份验证代码。

该文档提供了包括这些哈希的正确格式的 STUN 消息样本，以便测试 STUN 协议的实现。

## 向量测试

该文档提供了一系列十六进制值的测试向量，每对十六进制数字表示一个字节，以网络字节顺序表示。这些测试向量是用于测试 STUN 协议实现的，其中包括了 Interactive Connectivity Establishment (ICE)连接检查用例。这些消息包括 FINGERPRINT、MESSAGE-INTEGRITY 和 XOR-MAPPED-ADDRESS STUN 属性，这些属性被认为是最容易出现实现错误的。此外，该文档还提供了另一条消息，用于测试使用长期凭据进行 STUN 身份验证（ICE 不使用此功能）。

在以下示例消息中，包括了两种纯文本属性。其中某些属性的值被故意设置为需要填充的大小。非 ASCII 字符表示为<U+xxxx>，其中 xxxx 是其 Unicode 代码点的十六进制数。

在本文档中，ASCII 空格（U+0020）用于填充前三个消息，这是任意的。同样，最后一个消息使用空字节进行填充。根据[RFC5389]，填充字节可以采用任何值。

### 请求示例

该文档中的内容是一个 STUN 请求的示例，其中包括了使用的参数。该请求使用了以下参数：

- 软件名称： "STUN 测试客户端"（不带引号）
- 用户名： "evtj:h6vY"（不带引号）
- 密码： "VOkJxbRl1RmTxUk/WvJxBt"（不带引号）

```
          00 01 00 58     Request type and message length
          21 12 a4 42     Magic cookie
          b7 e7 a7 01  }
          bc 34 d6 86  }  Transaction ID
          fa 87 df ae  }
          80 22 00 10     SOFTWARE attribute header
          53 54 55 4e  }
          20 74 65 73  }  User-agent...
          74 20 63 6c  }  ...name
          69 65 6e 74  }
          00 24 00 04     PRIORITY attribute header
          6e 00 01 ff     ICE priority value
          80 29 00 08     ICE-CONTROLLED attribute header
          93 2f f9 b1  }  Pseudo-random tie breaker...
          51 26 3b 36  }   ...for ICE control
          00 06 00 09     USERNAME attribute header
          65 76 74 6a  }
          3a 68 36 76  }  Username (9 bytes) and padding (3 bytes)
          59 20 20 20  }
          00 08 00 14     MESSAGE-INTEGRITY attribute header
          9a ea a7 0c  }
          bf d8 cb 56  }
          78 1e f2 b5  }  HMAC-SHA1 fingerprint
          b2 d3 f2 49  }
          c1 b5 71 a2  }
          80 28 00 04     FINGERPRINT attribute header
          e5 7a 3b cf     CRC32 fingerprint
```

### iPv4 响应示例

该文档中的内容是一个 STUN 响应的示例，其中包括了使用的参数。该响应使用了以下参数：

- 密码： "VOkJxbRl1RmTxUk/WvJxBt"（不带引号）
- 软件名称： "测试向量"（不带引号）
- 映射地址：192.0.2.1 端口 32853

```
     01 01 00 3c     Response type and message length
     21 12 a4 42     Magic cookie
     b7 e7 a7 01  }
     bc 34 d6 86  }  Transaction ID
     fa 87 df ae  }
     80 22 00 0b     SOFTWARE attribute header
     74 65 73 74  }
     20 76 65 63  }  UTF-8 server name
     74 6f 72 20  }
     00 20 00 08     XOR-MAPPED-ADDRESS attribute header
     00 01 a1 47     Address family (IPv4) and xor'd mapped port number
     e1 12 a6 43     Xor'd mapped IPv4 address
     00 08 00 14     MESSAGE-INTEGRITY attribute header
     2b 91 f5 99  }
     fd 9e 90 c3  }
     8c 74 89 f9  }  HMAC-SHA1 fingerprint
     2a f9 ba 53  }
     f0 6b e7 d7  }
     80 28 00 04     FINGERPRINT attribute header
     c0 7d 4c 96     CRC32 fingerprint
```

2.3. IPv6 响应示例

该文档中的内容是一个 STUN 响应的示例，其中包括了使用的参数。该响应使用了以下参数：

- 密码： "VOkJxbRl1RmTxUk/WvJxBt"（不带引号）
- 软件名称： "测试向量"（不带引号）
- 映射地址：2001:db8:1234:5678:11:2233:4455:6677 端口 32853

```
  01 01 00 48 Response type and message length
  21 12 a4 42 Magic cookie
  b7 e7 a7 01 }
  bc 34 d6 86 } Transaction ID
  fa 87 df ae }
  80 22 00 0b SOFTWARE attribute header
  74 65 73 74 }
  20 76 65 63 } UTF-8 server name
  74 6f 72 20 }
  00 20 00 14 XOR-MAPPED-ADDRESS attribute header
  00 02 a1 47 Address family (IPv6) and xor'd mapped port number
  01 13 a9 fa }
  a5 d3 f1 79 } Xor'd mapped IPv6 address
  bc 25 f4 b5 }
  be d2 b9 d9 }
  00 08 00 14 MESSAGE-INTEGRITY attribute header
  a3 82 95 4e }
  4b e6 7b f1 }
  17 84 c9 7c } HMAC-SHA1 fingerprint
  82 92 c2 75 }
  bf e3 ed 41 }
  80 28 00 04 FINGERPRINT attribute header
  c8 fb 0b 4c CRC32 fingerprint
```

### 长期身份验证的请求示例

该文档中的内容是一个 STUN 请求的示例，其中包括了使用的参数。该请求使用了以下参数：

- 用户名： "<U+30DE><U+30C8><U+30EA><U+30C3><U+30AF><U+30B9>"（不带引号），未受 SASLprep [RFC4013]处理的影响。
- 密码： "The<U+00AD>M<U+00AA>tr<U+2168>" 和 "TheMatrIX"（不带引号），分别在 SASLprep 处理前和处理后。
- 随机数： "f//499k954d6OL34oL9FSTvy64sA"（不带引号）
- 领域： "example.org"（不带引号）

```
      00 01 00 60     Request type and message length
      21 12 a4 42     Magic cookie
      78 ad 34 33  }
      c6 ad 72 c0  }  Transaction ID
      29 da 41 2e  }
      00 06 00 12     USERNAME attribute header
      e3 83 9e e3  }
      83 88 e3 83  }
      aa e3 83 83  }  Username value (18 bytes) and padding (2 bytes)
      e3 82 af e3  }
      82 b9 00 00  }
      00 15 00 1c     NONCE attribute header
      66 2f 2f 34  }
      39 39 6b 39  }
      35 34 64 36  }
      4f 4c 33 34  }  Nonce value
      6f 4c 39 46  }
      53 54 76 79  }
      36 34 73 41  }
      00 14 00 0b     REALM attribute header
      65 78 61 6d  }
      70 6c 65 2e  }  Realm value (11 bytes) and padding (1 byte)
      6f 72 67 00  }
      00 08 00 14     MESSAGE-INTEGRITY attribute header
      f6 70 24 65  }
      6d d6 4a 3e  }
      02 b8 e0 71  }  HMAC-SHA1 fingerprint
      2e 85 c9 a2  }
      8c a8 96 66  }
```
