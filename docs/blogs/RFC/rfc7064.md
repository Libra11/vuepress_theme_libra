---
title: rfc7064
category: rfc
desc: URI Scheme for the Session Traversal Utilities for NAT (STUN) Protocol
tag:
  - rfc
picture: https://libra321.oss-cn-huhehaote.aliyuncs.com/img/boxmodel.png
date: "2023-05-24"
---

## 摘要

本文档指定了用于 NAT 会话遍历实用程序（STUN）协议的统一资源标识符（URI）方案的语法和语义。

## 简介

本文档指定了用于 NAT 会话遍历实用程序（STUN）协议的统一资源标识符（URI）方案的语法和语义。

STUN 是一种协议，用作其他协议处理网络地址转换器（NAT）遍历的工具。它可以被端点用于确定由 NAT 分配给它的 IP 地址和端口，以在两个端点之间执行连接性检查，并作为保持活动状态的协议以维护 NAT 绑定。RFC 5389 定义了 STUN 协议的具体规定。

“stun”和“stuns” URI 方案用于指定独立的 STUN 服务器或在 STUN 用途的上下文中执行 STUN 服务器操作的任何 Internet 主机。随着 WebRTC 等标准的出现，我们预计将有大量的端点和 Web 应用程序能够识别和与这样的 STUN 服务器通信，以执行 STUN 协议。这意味着端点和/或应用程序必须配置适当的配置来识别 STUN 服务器。具有不一致的语法会增加歧义，并可能导致不互操作的解决方案和实现限制。

“stun”和“stuns” URI 方案通过提供一种一致的方式来描述、配置和交换标识 STUN 服务器的信息，有助于缓解这些问题。

## “stun”或“stuns”URI 的定义

### URI 方案语法

“stun”和“stuns”URI 方案具有以下正式 ABNF 语法[RFC5234]：

```
stunURI = scheme ":" host [ ":" port ]
scheme = "stun" / "stuns"
```

和在[RFC3986]中指定。虽然这两个 ABNF 生成物在[RFC3986]中被定义为通用分层 URI 的组成部分，但这并不意味着“stun”和“stuns”URI 方案是分层 URI。开发人员不得使用通用分层 URI 解析器来解析“stun”或“stuns”URI。

### URI 方案语义

“stun”和“stuns”URI 方案用于指定独立的 STUN 服务器或在 STUN 用途（RFC 5389[RFC5389]的第 14 节）的上下文中执行 STUN 服务器操作的任何 Internet 主机。STUN 协议支持通过 UDP、TCP 或 TLS-over-TCP 发送消息。当 STUN 在 TLS-over-TCP（或将来的 DTLS-over-UDP）上运行时，必须使用“stuns”URI 方案，否则必须使用“stun”方案。

“stun”URI 的必需部分表示 STUN 服务器主机。

对于 RFC 5389 第 9 节中提到的可选 DNS 发现过程，“stun”URI 方案意味着 UDP 是 SRV 查找的传输协议，“stuns”URI 方案表示 TCP 是传输协议。

如[RFC5389]所指定，如果存在部分，则表示 STUN 服务器等待连接请求的端口。如果不存在，则 UDP 和 TCP 的默认端口均为 3478。STUN over TLS 的默认端口是 5349，如[RFC5389]第 9 节所述。

## 安全考虑

“stun”和“stuns”URI 方案不会引入任何特定的安全问题，除了[RFC3986]中讨论的安全注意事项。这些 URI 方案旨在用于涉及 NAT 遍历的特定环境中。使用该方案的用户需要仔细考虑使用环境的安全属性。

虽然“stun”或“stuns”URI 本身不包括用于验证 STUN 客户端的用户名或密码，但在某些环境中，例如 WebRTC，用户名和密码几乎肯定会由外部代理在向客户端发送“stuns”URI 的同时远程配置。因此，在这种情况下，如果用户名和密码以明文形式接收，则使用“stuns”URI 将几乎没有任何好处。因此，STUN 客户端必须确保在使用“stuns”URI 之前，用户名、密码、“stuns”URI 和任何其他安全相关参数都以等效的安全性接收。如果两个 TLS 会话都以相同的方式参数化，例如使用相应强度的密码套件，则在另一个 TLS 会话上接收这些参数可以提供适当的安全级别。
